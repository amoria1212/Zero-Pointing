<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- The Document Title will be set by JavaScript below -->
    <title>[DOCUMENT TITLE]</title> 
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Custom Brand Colors */
        :root {
            --deep-charcoal: #374151;
            --dusty-background: #f4f0ed;
            --pale-rose: #f0e8e6;
            --light-gray-silver: #D1D5DB;
            --dusty-rose: #D8A2A0;
            --champagne-gold: #E6D8A2;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            background-color: var(--dusty-background);
            color: var(--deep-charcoal);
        }

        h1, h2, h3, h4 {
            font-family: 'Cormorant Garamond', serif;
        }

        .section-header {
            position: relative;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .section-header::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 3px;
            background-color: var(--light-gray-silver);
            border-radius: 9999px;
        }

        .journal-box {
            background-color: var(--pale-rose);
            border-left: 4px solid var(--light-gray-silver);
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .journal-input {
            width: 100%;
            min-height: 3rem;
            border: 1px solid #d1d5db;
            background-color: #fff;
            padding: 0.5rem;
            border-radius: 0.375rem;
            resize: vertical;
            transition: border-color 0.2s ease;
        }

        .journal-input:focus {
            outline: none;
            border-color: var(--light-gray-silver);
            box-shadow: 0 0 0 3px rgba(209, 213, 219, 0.5);
        }

        .info-box {
            background: #fdfae9;
            border: 1px solid var(--champagne-gold);
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .btn {
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .logo-container {
            text-align: center;
            margin-bottom: 2rem;
        }

        .brand-subtitle {
            color: #6B7280; /* A slightly softer gray for the subtitle */
            font-size: 0.9rem;
            font-style: italic;
        }
        
        /* --- Sharing Modal Styles --- */
        .share-modal {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex; align-items: center; justify-content: center;
            z-index: 2000;
            opacity: 0; visibility: hidden; transition: all 0.3s ease;
        }
        .share-modal.show { opacity: 1; visibility: visible; }
        .share-modal-content {
            background: white; padding: 2rem; border-radius: 1rem;
            max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;
        }
        .share-option {
            display: flex; align-items: center; width: 100%; padding: 1rem;
            margin-bottom: 0.75rem; border-radius: 0.75rem; border: none;
            cursor: pointer; transition: all 0.2s ease; text-align: left;
        }
        .share-option:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        .share-option .icon { font-size: 1.5rem; margin-right: 1rem; min-width: 2rem; }
        .share-option .content { flex: 1; }
        .share-option .title { font-weight: 600; margin-bottom: 0.25rem; }
        .share-option .description { font-size: 0.875rem; opacity: 0.8; }
        
        /* --- Save Indicator Styles --- */
        .save-indicator {
            position: fixed; top: 20px; right: 20px; padding: 8px 16px;
            border-radius: 20px; font-size: 0.875rem; font-weight: 500;
            opacity: 0; transition: all 0.3s ease; z-index: 1000;
            pointer-events: none;
        }
        .save-indicator.show { opacity: 1; }
        .save-indicator.saving { background-color: #FEF3C7; color: #92400E; border: 1px solid #FDE68A; }
        .save-indicator.saved { background-color: #D1FAE5; color: #065F46; border: 1px solid #A7F3D0; }
        .save-indicator.error { background-color: #FEE2E2; color: #991B1B; border: 1px solid #FECACA; }
        .save-indicator.success { background-color: #D1FAE5; color: #065F46; border: 1px solid #A7F3D0; }


        /* --- Print Styles --- */
        @media print {
            .no-print { display: none !important; }
            body { background-color: white !important; }
            .journal-box { 
                background-color: #f9f9f9 !important; 
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <!-- Modal for Sharing -->
    <div id="shareModal" class="share-modal no-print">
        <div class="share-modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">Share Your Responses</h3>
                <button onclick="closeShareModal()" class="text-gray-500 hover:text-gray-700 text-2xl close-button">&times;</button>
            </div>
            <p class="text-gray-600 mb-4">Choose how you'd like to share your responses:</p>
            <div class="space-y-3">
                <button onclick="shareViaEmail()" class="share-option" style="background-color: #EFF6FF; color: #1D4ED8;">
                    <span class="icon">üìß</span>
                    <div class="content"><div class="title">Email</div><div class="description">Send via your email client</div></div>
                </button>
                <button onclick="copyToClipboard()" class="share-option" style="background-color: #F0FDF4; color: #15803D;">
                    <span class="icon">üìã</span>
                    <div class="content"><div class="title">Copy to Clipboard</div><div class="description">Copy text to paste anywhere</div></div>
                </button>
                <button onclick="shareViaWebAPI()" class="share-option" id="webShareButton" style="background-color: #FAF5FF; color: #7C3AED; display: none;">
                    <span class="icon">üì≤</span>
                    <div class="content"><div class="title">Share</div><div class="description">Use device sharing options</div></div>
                </button>
                <button onclick="downloadFile()" class="share-option" style="background-color: #FFF7ED; color: #C2410C;">
                    <span class="icon">üíæ</span>
                    <div class="content"><div class="title">Download File</div><div class="description">Save as text file</div></div>
                </button>
            </div>
            <div class="mt-4 p-3 bg-yellow-50 rounded-lg">
                <p class="text-sm text-yellow-700"><strong>Privacy Note:</strong> Your responses contain personal information. Share thoughtfully.</p>
            </div>
        </div>
    </div>

    <!-- Save Indicator -->
    <div id="saveIndicator" class="save-indicator no-print">
        <span id="saveText">Auto-saving...</span>
    </div>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto bg-white p-6 sm:p-10 rounded-3xl shadow-2xl border border-gray-100">
        <div class="logo-container">
            <img src="https://i.imgur.com/JwAdvDd.png" alt="Janice LaFountaine, MS, LMFT Logo" class="h-24 w-auto mx-auto rounded-full shadow-md">
            <p class="brand-subtitle mt-2">Janice LaFountaine, MS, LMFT</p>
        </div>

        <!-- Control Buttons -->
        <div class="no-print flex flex-wrap gap-3 mb-6 justify-center sm:justify-end">
            <button onclick="openShareModal()" class="px-4 py-2 bg-purple-100 text-purple-800 rounded-lg hover:bg-purple-200 transition-colors text-sm font-medium btn">
                üîó Share
            </button>
            <button onclick="exportData()" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium btn">
                üì§ Export Responses
            </button>
            <button onclick="clearData()" class="px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors text-sm font-medium btn">
                üóëÔ∏è Clear All
            </button>
            <button onclick="window.print()" class="px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm font-medium btn">
                üñ®Ô∏è Print
            </button>
        </div>

        <!-- Header -->
        <header class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-2">[DOCUMENT TITLE]</h1>
            <p class="text-gray-600 leading-relaxed text-lg mb-4">
                This Program Clearing Homework is based on Morgan Lee's ‚ÄúZero Pointing Programs‚Äù method. It's designed to help you identify and release limiting beliefs and emotional patterns.
            </p>
            <div class="info-box text-sm text-gray-700">
                <p class="mb-2">üí° <strong>Gentle Reminder:</strong> There are no right or wrong answers. Your responses are automatically saved in your browser, so you can work at your own pace. This is your space for curious, compassionate self-reflection.</p>
            </div>
        </header>

        <!-- ================================================================= -->
        <!-- ================== START YOUR CONTENT HERE ================== -->
        <!-- ================================================================= -->

        <section class="mb-8">
            <h2 class="section-header text-2xl font-semibold">Step 1: Parental Figure Analysis</h2>
            
            <div class="journal-box">
                <h3 class="text-lg font-medium mb-3">Parental Figure 1</h3>
                <p class="text-sm mb-3">Identify a parental figure. In the box below, create two columns. In the left column, list all negative attributes you associate with this person. In the right column, write the polar opposite of each negative attribute.</p>
                <textarea class="journal-input" rows="6" data-key="parent1-neg-pos" placeholder="Example:&#10;Controlling      |   Trusting&#10;Judgmental     |   Accepting"></textarea>
            </div>

            <div class="journal-box">
                <h3 class="text-lg font-medium mb-3">Parental Figure 2</h3>
                <p class="text-sm mb-3">Repeat the same two-column process for a second parental figure.</p>
                <textarea class="journal-input" rows="6" data-key="parent2-neg-pos" placeholder="Negative Attribute   |   Polar Opposite"></textarea>
            </div>
        </section>

        <section class="mb-8">
            <h2 class="section-header text-2xl font-semibold">Step 2: Significant Relationships Review</h2>
            
            <div class="journal-box">
                <h3 class="text-lg font-medium mb-3">Other Important Figures</h3>
                <p class="text-sm mb-3">Repeat the negative/opposite attribute process for other important figures from your past and present (e.g., siblings, partners, friends, mentors).</p>
                <textarea class="journal-input" rows="6" data-key="other-figures-neg-pos" placeholder="Figure's Name:&#10;Negative Attribute   |   Polar Opposite"></textarea>
            </div>

            <div class="journal-box">
                <h3 class="text-lg font-medium mb-3">Self-Assessment</h3>
                <p class="text-sm mb-3">Now, apply the same process to yourself. List negative attributes you associate with yourself and write their polar opposites.</p>
                <textarea class="journal-input" rows="6" data-key="self-neg-pos" placeholder="Negative Self-Attribute   |   Polar Opposite"></textarea>
            </div>
        </section>
        
        <section class="mb-8">
            <h2 class="section-header text-2xl font-semibold">Step 3: Core Belief Systems Examination</h2>
            
            <div class="journal-box">
                <h3 class="text-lg font-medium mb-3">Beliefs, Archetypes, and Patterns</h3>
                <p class="text-sm mb-3">Apply the attribute-and-opposite analysis to your core beliefs (about life, success, relationships), archetypal patterns you identify with, and any known mental or behavioral programs you've recognized.</p>
                <textarea class="journal-input" rows="6" data-key="core-beliefs-neg-pos" placeholder="Example Belief:&#10;I am not worthy    |   I am fully worthy&#10;&#10;Example Pattern:&#10;Procrastination    |   Inspired Action"></textarea>
            </div>
        </section>

        <section class="mb-8">
            <h2 class="section-header text-2xl font-semibold">Step 5: Positive Attributes Analysis</h2>
            
            <div class="journal-box">
                <h3 class="text-lg font-medium mb-3">Positive Attributes: All Individuals & Self</h3>
                <p class="text-sm mb-3">Return to all the individuals from Steps 1-2 (including yourself). Now, create two-column lists focusing on their positive attributes and the polar opposite of each positive attribute.</p>
                <textarea class="journal-input" rows="8" data-key="all-figures-pos-opp" placeholder="Example:&#10;Person's Name:&#10;Kind         |   Cruel&#10;Generous     |   Selfish"></textarea>
            </div>
        </section>

        <section class="mb-8">
            <h2 class="section-header text-2xl font-semibold">Clearing and Reprogramming Statement</h2>
            <p class="mb-4 text-gray-600">Use the following statement to process the attribute pairs you've identified. For each pair, recite the statement with intention, addressing the negative trait, its opposite, a core belief, or a pattern.</p>

            <div class="info-box text-gray-800">
                <h3 class="text-lg font-semibold mb-2">Clearing Statement</h3>
                <p class="mb-3">‚ÄúI Accept, Allow, Honour, Value, Trust, Respect, Forgive, Love, Believe, Receive, Release, Surrender, Command, am Grateful, am free and accept full responsibility for all energies associated with <strong>(insert target attribute here)</strong>:</p>
                <p class="text-sm text-gray-600 italic leading-relaxed">
                    <strong>(all of that)</strong><br>
                    All Unconscious, collective consciousness, Miasmic memory, Collective and Personal Timelines, artificial intelligence, all inorganic energy, DNA Programming, Cellular Memory, Neural Pathways, 3D Concepts, Chakras, Templates, Grids, Projections, Manifestations, Karma, Identities, Associations, Fields, Archetypes, loops, Shadow energy, Beliefs, Patterns, Behaviours, Habits, Ideas, Cycles, Thoughts, Generations back and Generations forth etc.
                    <br><br>
                    All Resistance, All Attachment, All Judgement, All Projection, Covering all Dimensions are (now) Pure Love.
                    <br>
                    Thank you. It Is Done.‚Äù
                </p>
                <p class="text-xs text-gray-500 mt-2">Method by Morgan Lee¬©</p>
            </div>

        </section>
        
        <!-- ================================================================= -->
        <!-- =================== END YOUR CONTENT HERE =================== -->
        <!-- ================================================================= -->

        <!-- Footer -->
        <footer class="text-center pt-8 border-t border-gray-200">
            <p class="text-sm text-gray-500">
                Remember: You have the strength to stay present. Take it one moment at a time.
            </p>
            <p class="text-xs text-gray-400 mt-2">
                Collaborating Wellness | Janice LaFountaine, MS, LMFT
            </p>
        </footer>
    </div>

    <script>
        // =================================================
        //  DOCUMENT CONFIGURATION - EDIT THIS FOR EACH FILE
        // =================================================
        const DOCUMENT_TITLE = "Emotional Integration Program Clearing"; 
        // =================================================


        // --- ALL JAVASCRIPT FUNCTIONS FOR BUTTONS AND DATA HANDLING ARE BELOW ---

        // GLOBAL VARIABLES
        let saveTimeout;
        const saveIndicator = document.getElementById('saveIndicator');
        const saveText = document.getElementById('saveText');

        // INITIALIZATION
        document.addEventListener('DOMContentLoaded', function() {
            // Set the page title and H1 from the variable
            document.title = DOCUMENT_TITLE;
            const mainHeader = document.querySelector('h1');
            if(mainHeader) mainHeader.textContent = DOCUMENT_TITLE;

            loadSavedData();
            // Show the native web share button only if the browser supports it
            if (navigator.share) {
                document.getElementById('webShareButton').style.display = 'flex';
            }
            // Add listeners for closing the modal
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closeShareModal();
            });
            document.getElementById('shareModal').addEventListener('click', function(e) {
                if (e.target === this) closeShareModal();
            });
        });

        // AUTO-SAVE
        document.addEventListener('input', function(e) {
            if (e.target.matches('textarea[data-key], input[data-key]')) {
                showSaveIndicator('saving');
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(() => {
                    saveData(e.target);
                    showSaveIndicator('saved');
                    setTimeout(() => hideSaveIndicator(), 2000);
                }, 500);
            }
        });

        document.addEventListener('change', function(e) {
            if (e.target.matches('input[type="checkbox"][data-key]')) {
                saveData(e.target);
                showSaveIndicator('saved');
                setTimeout(() => hideSaveIndicator(), 1000);
            }
        });
        
        // DATA MANAGEMENT
        function saveData(element) {
            const key = DOCUMENT_TITLE + '_' + element.getAttribute('data-key'); // Use a unique key per document
            if (element.type === 'checkbox') {
                localStorage.setItem(key, element.checked);
            } else {
                localStorage.setItem(key, element.value);
            }
        }

        function loadSavedData() {
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = DOCUMENT_TITLE + '_' + element.getAttribute('data-key');
                const saved = localStorage.getItem(key);
                if (saved !== null) {
                    if (element.type === 'checkbox') {
                        element.checked = saved === 'true';
                    } else {
                        element.value = saved;
                    }
                }
            });
        }

        function showSaveIndicator(status) {
            saveIndicator.className = `save-indicator show ${status}`;
            const messages = { saving: 'Auto-saving...', saved: '‚úì Saved', success: '‚úì Success', error: '‚úó Error' };
            saveText.textContent = messages[status] || status;
        }

        function hideSaveIndicator() {
            saveIndicator.classList.remove('show');
        }

        // MODAL FUNCTIONS
        function openShareModal() { document.getElementById('shareModal').classList.add('show'); }
        function closeShareModal() { document.getElementById('shareModal').classList.remove('show'); }

        // DATA COLLECTION & FORMATTING
        function collectAllData() {
            const data = {};
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.getAttribute('data-key');
                let value;
                if (element.type === 'checkbox') {
                    value = element.checked ? element.parentNode.textContent.trim() : null;
                } else {
                    value = element.value.trim();
                }
                if (value) { data[key] = value; }
            });
            return data;
        }

        function formatDataForSharing() {
            const data = collectAllData();
            const date = new Date().toLocaleDateString();

            let shareText = `${DOCUMENT_TITLE} - RESPONSES\n`;
            shareText += `Date: ${date}\n`;
            shareText += `Therapist: Janice LaFountaine, MS, LMFT\n`;
            shareText += `${'='.repeat(60)}\n\n`;
            
            // =================================================================
            //  CUSTOMIZE THIS SECTION FOR EACH HOMEWORK FILE
            // =================================================================
            // This 'sections' array controls how your exported text file is formatted.
            // Match the 'title' to your section headers and the 'keys' to the 
            // `data-key` attributes you used in the HTML content.
            const sections = [
                {
                    title: 'Step 1: Parental Figure Analysis',
                    keys: {
                        'parent1-neg-pos': 'Parental Figure 1: Negative Attributes & Opposites',
                        'parent2-neg-pos': 'Parental Figure 2: Negative Attributes & Opposites'
                    }
                },
                {
                    title: 'Step 2: Significant Relationships Review',
                    keys: {
                        'other-figures-neg-pos': 'Other Important Figures: Negative Attributes & Opposites',
                        'self-neg-pos': 'Self-Assessment: Negative Attributes & Opposites'
                    }
                },
                {
                    title: 'Step 3: Core Belief Systems Examination',
                    keys: {
                        'core-beliefs-neg-pos': 'Core Beliefs, Archetypes, and Patterns'
                    }
                },
                {
                    title: 'Step 5: Positive Attributes Analysis',
                    keys: {
                        'all-figures-pos-opp': 'All Individuals & Self: Positive Attributes & Opposites'
                    }
                }
            ];
            // =================================================================

            sections.forEach(section => {
                let hasContent = false;
                let sectionText = `${section.title}\n${'-'.repeat(section.title.length)}\n\n`;
                
                Object.entries(section.keys).forEach(([key, label]) => {
                    if (data[key]) {
                        hasContent = true;
                        sectionText += `‚Ä¢ ${label}:\n  ${data[key].replace(/\n/g, '\n  ')}\n\n`; // Indents multi-line responses
                    }
                });
                
                if (hasContent) { shareText += sectionText + '\n'; }
            });

            shareText += `\n${'='.repeat(60)}\n`;
            shareText += `Generated: ${date}`;

            return shareText;
        }

        // SHARING FUNCTIONS
        function shareViaEmail() {
            try {
                const shareText = formatDataForSharing();
                const subject = encodeURIComponent(`${DOCUMENT_TITLE} Responses`);
                const body = encodeURIComponent(shareText);
                window.location.href = `mailto:?subject=${subject}&body=${body}`;
                closeShareModal();
                showSaveIndicator('success'); saveText.textContent = '‚úì Email opened'; setTimeout(() => hideSaveIndicator(), 2000);
            } catch (error) { 
                console.error('Email error:', error);
                showSaveIndicator('error'); saveText.textContent = '‚úó Email failed'; setTimeout(() => hideSaveIndicator(), 3000); 
            }
        }

        async function copyToClipboard() {
            try {
                const shareText = formatDataForSharing();
                await navigator.clipboard.writeText(shareText);
                closeShareModal();
                showSaveIndicator('success'); saveText.textContent = '‚úì Copied to clipboard'; setTimeout(() => hideSaveIndicator(), 2000);
            } catch (error) {
                console.error('Copy error:', error);
                closeShareModal(); showSaveIndicator('error'); saveText.textContent = '‚úó Copy failed'; setTimeout(() => hideSaveIndicator(), 3000);
            }
        }
        
        async function shareViaWebAPI() {
            if (!navigator.share) {
                showSaveIndicator('error'); saveText.textContent = '‚úó Sharing not supported'; setTimeout(() => hideSaveIndicator(), 3000);
                return;
            }
            try {
                const shareText = formatDataForSharing();
                await navigator.share({ title: `${DOCUMENT_TITLE} Responses`, text: shareText });
                closeShareModal();
                showSaveIndicator('success'); saveText.textContent = '‚úì Shared successfully'; setTimeout(() => hideSaveIndicator(), 2000);
            } catch (error) {
                if (error.name !== 'AbortError') {
                    console.error('Share error:', error);
                    showSaveIndicator('error'); saveText.textContent = '‚úó Sharing failed'; setTimeout(() => hideSaveIndicator(), 3000);
                }
                closeShareModal();
            }
        }
        
        function downloadFile(isExport = false) { // Combined function for both buttons
            try {
                const shareText = formatDataForSharing();
                const date = new Date().toISOString().split('T')[0];
                const blob = new Blob([shareText], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                const fileNameBase = DOCUMENT_TITLE.replace(/[^a-z0-9]/gi, '_').toLowerCase();
                a.download = `${fileNameBase}_responses_${date}.txt`;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                closeShareModal();
                const message = isExport ? '‚úì Exported successfully' : '‚úì Downloaded successfully';
                showSaveIndicator('success'); saveText.textContent = message; setTimeout(() => hideSaveIndicator(), 2000);
            } catch (error) {
                console.error('Download/Export error:', error);
                const message = isExport ? '‚úó Export failed' : '‚úó Download failed';
                closeShareModal(); showSaveIndicator('error'); saveText.textContent = message; setTimeout(() => hideSaveIndicator(), 3000);
            }
        }
        
        // CORE BUTTON FUNCTIONS
        function exportData() {
            downloadFile(true); // Call the download function with an 'export' flag
        }

        function clearData() {
            if (confirm('Are you sure you want to clear all responses for this document? This cannot be undone.')) {
                document.querySelectorAll('[data-key]').forEach(element => {
                    const key = DOCUMENT_TITLE + '_' + element.getAttribute('data-key');
                    if (element.type === 'checkbox') {
                        element.checked = false;
                    } else {
                        element.value = '';
                    }
                    localStorage.removeItem(key);
                });
                showSaveIndicator('success'); saveText.textContent = '‚úì Responses cleared'; setTimeout(() => hideSaveIndicator(), 2000);
            }
        }
    </script>
</body>
</html>
